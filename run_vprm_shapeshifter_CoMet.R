# vprm_shapeshifter.R
# Conversion tool that morphs VPRM input files generated by VPRM preprocessor on Panorama (Christoph Gerbig)
# into final vprm_input_dXX_[date] files read by WRF-CHEM
# M. Galkowski, MPI-BGC Jena, 2018


# Operational folder for preparing WRF-input for CoMet runs.
# Main function enables running for a single domain, which is selected
# in the function call below. For detailed description, see function source
# file.

# This script runs on Mistral, DKRZ.
source("/work/mj0143/b301033/Projects/WRF_Tools/vprm_shapeshifter/f_vprm_shapeshifter.R")


# Code for example run on Mistral (DKRZ) for CoMet 2018 mission:
f_vprm_shapeshifter( vprm_input_dir    = "/work/mj0143/b301033/Data/CoMet_input/Emissions/VPRM_input/MODIS_indices",
                           output_dir        = "/work/mj0143/b301033/Data/CoMet_input/Emissions/VPRM_input/WRF_input",
                           requested.domains = c("d01", "d02", "d03"),
                           current.year      = 2018,
                           add.kaplan.model.input = T,
                           kaplan_input_dir  = "/work/mj0143/b301033/Data/CoMet_input/Emissions/VPRM_input/Kaplan_wetlands/vprm_shapeshifter_input")


# DEVELOPMENT / TESTS ##########################################################################################3
# Code for example run on Mistral (DKRZ) for development / testing:
#f_preprocess.VPRM.for.WRF( input_dir      = "/work/mj0143/b301033/Data/CoMet_input/Emissions/VPRM_input/yearly",
#                          output_dir     = "/work/mj0143/b301033/Projects/WRF_Tools/vprm_shapeshifter/results",
                        #  requested.domains = "d01",
                         # current.year   = 2018,
                         # add.kaplan.model.input     = F,
                         # load.precalculated.indices = F )
